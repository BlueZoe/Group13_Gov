{"remainingRequest":"E:\\Government\\client2.0\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Government\\client2.0\\client\\src\\views\\user.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"E:\\Government\\client2.0\\client\\src\\views\\user.vue","mtime":1575559705717},{"path":"E:\\Government\\client2.0\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Government\\client2.0\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\Government\\client2.0\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\Government\\client2.0\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Government\\client2.0\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKICAgIC51c2VyIC5lbC1mb3JtLWl0ZW1fX2xhYmVsewogICAgICAgIGNvbG9yOiAjZTRlZGY4IWltcG9ydGFudDsKICAgIH0KICAgIC51c2VyewogICAgICAgIHBhZGRpbmctdG9wOiAyMHB4OwogICAgfQogICAgLmxhYmVsX2NvbG9yIC5lbC10YWJzX19pdGVtewogICAgICAgIGNvbG9yOiAjZTRlZGY4IWltcG9ydGFudDsKICAgIH0KICAuZWwtaW5wdXQuaXMtZGlzYWJsZWQgLmVsLWlucHV0X19pbm5lcnsKICBjb2xvcjogIzAzMDkxMyFpbXBvcnRhbnQ7CiAgfQogIC5lbC10YWJzLS10b3AgLmVsLXRhYnNfX2l0ZW0uaXMtdG9wOm50aC1jaGlsZCgyKSB7CiAgICBwYWRkaW5nLWxlZnQ6IDEwMCUhaW1wb3J0YW50OwogIH0KICAuZWwtdGFicy0tdG9wIC5lbC10YWJzX19pdGVtLmlzLXRvcDpsYXN0LWNoaWxkIHsKICAgIHBhZGRpbmctbGVmdDogMTAwJSFpbXBvcnRhbnQ7Cn0KICAuZWwtdGFic19fbmF2LXdyYXA6OmFmdGVyIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZSFpbXBvcnRhbnQ7CiAgICBsZWZ0OiAwIWltcG9ydGFudDsKICAgIGJvdHRvbTogMCFpbXBvcnRhbnQ7CiAgICB3aWR0aDogNjUlIWltcG9ydGFudDsKICAgIGhlaWdodDogMnB4IWltcG9ydGFudDsKICB9CiAgLmVsLXRhYnN7CiAgICBwYWRkaW5nLWxlZnQ6IDMwJSFpbXBvcnRhbnQ7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXIhaW1wb3J0YW50OwogIH0K"},{"version":3,"sources":["user.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user.vue","sourceRoot":"src/views","sourcesContent":["<template>\n     <div class=\"all-container\">\n        <div class=\"all-container-padding bg\" >\n         <el-tabs class=\"label_color\" v-model=\"activeName\" @tab-click=\"handleClick\">\n          <el-tab-pane  label=\"基本信息\" name=\"first\">\n            <el-form class=\"user\" :model=\"userlist\" :rules=\"rules\" ref=\"EditorUserForms\">\n                <el-form-item label=\"用户名\"  prop=\"username\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">  <el-input v-model=\"userlist.username\" disabled ></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"真实姓名\" prop=\"real_name\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">  <el-input v-model=\"userlist.real_name\" disabled ></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"性别\" prop=\"gender\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">  <el-input v-model=\"userlist.gender\" disabled ></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"电话\" prop=\"telephone\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"userlist.telephone\" placeholder=\"请输入电话\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"邮箱\" prop=\"email\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"userlist.email\" placeholder=\"请输入邮箱\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"工作部门\" prop=\"department\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"userlist.department\" placeholder=\"工作部门\" ></el-input></el-col>\n                </el-form-item>\n              <el-form-item label=\"工作时间\" prop=\"worktime\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"userlist.worktime\" disabled ></el-input></el-col>\n                </el-form-item>\n            </el-form>\n            <div class=\"grid-content bg-purple\">\n             <el-button type=\"primary\"  @click=\"EditorUserClick('userlist')\" >保存</el-button>\n            </div>\n          </el-tab-pane>\n          <el-tab-pane label=\"修改密码\" name=\"second\">\n            <el-form class=\"user\" :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\">\n             <el-form-item label=\"原密码\" prop=\"pass\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"ruleForm.pass\" placeholder=\"请输入原密码\" type=\"password\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"新密码\" prop=\"newpass\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\"><el-input v-model=\"ruleForm.newpass\" placeholder=\"请输入新密码\" id=\"newkey\" type=\"password\"></el-input></el-col>\n                </el-form-item>\n                <el-form-item label=\"重复新密码\" prop=\"checknewpass\" :label-width=\"formLabelWidth\">\n                  <el-col :span=\"8\">   <el-input v-model=\"ruleForm.checknewpass\" placeholder=\"请再次输入新密码\" id='newkey1' type=\"password\"></el-input></el-col>\n                </el-form-item>\n                </el-form>\n                <div class=\"grid-content bg-purple\">\n             <el-button type=\"primary\"  @click=\"submitForm('ruleForm')\">保存</el-button>\n            </div>\n          </el-tab-pane>\n        </el-tabs>\n        </div>\n     </div>\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n  data() {\n/*****检验两次密码是否一致***/\n    var validatePass = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请输入密码\"));\n      } else if(value.length<8){\n          callback(new Error(\"请输入长度大于8的密码！！\"));\n      }\n      else {\n        if (this.ruleForm.checknewpass !== \"\") {\n          this.$refs.ruleForm.validateField(\"checknewpass\");\n        }\n        callback();\n      }\n    };\n    var validatePass2 = (rule, value, callback) => {\n      if (value === \"\") {\n        callback(new Error(\"请再次输入密码\"));\n      } else if (value !== this.ruleForm.newpass) {\n        callback(new Error(\"两次输入密码不一致!\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      ruleForm: {},//修改密码的表单\n      activeName: \"first\",\n      loading: true,\n      userlist: {},//用户信息表单\n      formLabelWidth: \"150px\",\n    /***校验***/\n      rules: {\n        telephone: [\n          {\n            required: true,\n            message: \"请输入电话号码\"\n          },\n          {\n            pattern: /^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$/,\n            message: \"手机格式不对\"\n          }\n        ],\n        email: [\n          {\n            required: true,\n            message: \"请输入电子邮箱\"\n          },\n          {\n            pattern: /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\\.[a-zA-Z0-9_-]{2,3}){1,2})$/,\n            message: \"请输入有效的邮箱\"\n          }\n        ],\n        department:[\n            {\n            required: true,\n            message: \"请输入工作部门\"\n            },\n            {\n            pattern: /^(环保局|工商局|街道办|人事处|城管大队)$/,\n            message: \"没有该部门\"\n            }\n        ],\n        pass: [\n          {\n            //required: true,\n            trigger: \"blur\",\n            message: \"请输入密码\"\n          },\n        ],\n\n        newpass: [\n          {\n            validator: validatePass,\n            trigger: \"blur\"\n          },\n        ],\n        checknewpass: [\n          {\n            validator: validatePass2,\n            trigger: \"blur\"\n          }\n        ]\n      },\n    };\n  },\n  created() {\n    this.getUser();\n  },\n  computed: {\n\n  },\n  methods: {\n    //获取个人用户的信息\n    getUser() {\n         axios.get('http://127.0.0.1:5000/api/user_info').then(response => (this.userlist = response))\n    },\n    //tab切换\n    handleClick(tab, event) {\n      console.log(tab, event);\n    },\n\n    //修改密码\n    submitForm(ruleForm) {\n      var obj = {\n        username: this.username,\n        oldpwd: this.ruleForm.pass,\n        newpwd: this.ruleForm.newpass,\n        checknewpass:this.ruleForm.checknewpass,\n      };\n      console.log(obj);\n\n      if(obj.newpwd === obj.checknewpass&&obj.newpwd.length>7)\n      {\n          let that = this;\n          axios.post('http://127.0.0.1:5000/api/change_password',{oldpass:obj.oldpwd,newpass:obj.newpwd })\n              .then(function (res) {\n            if(res===1){\n                that.$message({\n                    message:\"修改成功\",\n                    type:\"success\"\n                })\n            }else{\n                that.$message({\n                    message:\"原密码错误\",\n                    type:\"error\"\n                })\n            }\n        });\n        this.ruleForm.pass = \"\";\n        this.ruleForm.newpass = \"\";\n        this.ruleForm.checknewpass = \"\";\n      }\n      /*postData(\"接口\", obj).then(response => {\n        if (response.status == 200) {\n          this.$message({\n            message: \"保存成功\",\n            type: \"success\"\n          });\n        } else {\n          this.$message({\n            message: \"修改失败\" + response.message,\n            type: \"error\"\n          });\n        }\n      });*/\n    },\n    // 编辑提交的方法\n    EditorUserClick() {\n      this.$refs.EditorUserForms.validate(valid => {\n        if (valid) {\n          console.log(this.userlist);\n          axios.post('http://127.0.0.1:5000/api/user_info_change',{userinfo:this.userlist})\n              // .then(function (res) {\n              //   console.log(res);\n              // });\n          this.$message(\n              {\n                  message:\"修改成功\",\n                  type:\"success\"\n              }\n          )\n        }\n      });\n    }\n  }\n};\n</script>\n<style>\n    .user .el-form-item__label{\n        color: #e4edf8!important;\n    }\n    .user{\n        padding-top: 20px;\n    }\n    .label_color .el-tabs__item{\n        color: #e4edf8!important;\n    }\n  .el-input.is-disabled .el-input__inner{\n  color: #030913!important;\n  }\n  .el-tabs--top .el-tabs__item.is-top:nth-child(2) {\n    padding-left: 100%!important;\n  }\n  .el-tabs--top .el-tabs__item.is-top:last-child {\n    padding-left: 100%!important;\n}\n  .el-tabs__nav-wrap::after {\n    position: absolute!important;\n    left: 0!important;\n    bottom: 0!important;\n    width: 65%!important;\n    height: 2px!important;\n  }\n  .el-tabs{\n    padding-left: 30%!important;\n    text-align: center!important;\n  }\n</style>\n"]}]}